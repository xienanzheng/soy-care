import{t as f}from"./differenceInCalendarDays-qwJqrl5B.js";import{c as b}from"./format-DsNdWjgr.js";import{a as _,f as p,e as y,g as a,s as o}from"./index-DykhQkCz.js";import{a as h}from"./rewards-DUz26ILh.js";function L(r,s){const i=f(r);return isNaN(s)?b(r,NaN):(s&&i.setDate(i.getDate()+s),i)}function N(r){const{user:s}=_(),i=p(),u=y({queryKey:["food_logs",r],queryFn:async()=>{if(!s||!r)return[];const{data:e,error:n}=await o.from("food_logs").select("*").eq("pet_id",r).order("logged_at",{ascending:!1});if(n)throw n;return e.map(t=>({id:t.id,petId:t.pet_id,foodName:t.name,amountGrams:Number(t.amount_grams)||0,mealType:t.meal_type,notes:t.notes||void 0,timestamp:t.logged_at,photoUrl:t.photo_url||void 0,calories:t.calories?Number(t.calories):void 0,proteinPercent:t.protein_percent?Number(t.protein_percent):void 0,fatPercent:t.fat_percent?Number(t.fat_percent):void 0,carbPercent:t.carb_percent?Number(t.carb_percent):void 0}))},enabled:!!s&&!!r}),c=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("food_logs").insert({pet_id:e.petId,user_id:s.id,name:e.foodName,amount_grams:e.amountGrams,meal_type:e.mealType,notes:e.notes||null,photo_url:e.photoUrl||null,logged_at:e.timestamp,calories:e.calories||null,protein_percent:e.proteinPercent||null,fat_percent:e.fatPercent||null,carb_percent:e.carbPercent||null}).select().single();if(t)throw t;return n},onSuccess:e=>{i.invalidateQueries({queryKey:["food_logs",r]}),h("food_log",{log_id:e==null?void 0:e.id})}}),l=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("food_logs").update({name:e.foodName,amount_grams:e.amountGrams,meal_type:e.mealType,notes:e.notes||null,photo_url:e.photoUrl||null,logged_at:e.timestamp,calories:e.calories||null,protein_percent:e.proteinPercent||null,fat_percent:e.fatPercent||null,carb_percent:e.carbPercent||null}).eq("id",e.id).select().single();if(t)throw t;return n},onSuccess:()=>{i.invalidateQueries({queryKey:["food_logs",r]})}}),d=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{error:n}=await o.from("food_logs").delete().eq("id",e);if(n)throw n},onSuccess:()=>{i.invalidateQueries({queryKey:["food_logs",r]})}});return{logs:u.data??[],isLoading:u.isLoading,createLog:c.mutateAsync,isCreating:c.isPending,updateLog:l.mutateAsync,isUpdating:l.isPending,deleteLog:d.mutateAsync,isDeleting:d.isPending}}function P(r){const{user:s}=_(),i=p(),u=y({queryKey:["supplement_logs",r],queryFn:async()=>{if(!s||!r)return[];const{data:e,error:n}=await o.from("supplement_logs").select("*").eq("pet_id",r).order("logged_at",{ascending:!1});if(n)throw n;return e.map(t=>({id:t.id,petId:t.pet_id,supplementName:t.name,dosage:t.dosage||"",frequency:t.frequency,notes:t.notes||void 0,photoUrl:t.photo_url||void 0,timestamp:t.logged_at,purpose:t.purpose||void 0}))},enabled:!!s&&!!r}),c=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("supplement_logs").insert({pet_id:e.petId,user_id:s.id,name:e.supplementName,dosage:e.dosage,frequency:e.frequency,notes:e.notes||null,photo_url:e.photoUrl||null,logged_at:e.timestamp,purpose:e.purpose||null}).select().single();if(t)throw t;return n},onSuccess:e=>{i.invalidateQueries({queryKey:["supplement_logs",r]}),h("supplement_log",{log_id:e==null?void 0:e.id})}}),l=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("supplement_logs").update({name:e.supplementName,dosage:e.dosage,frequency:e.frequency,notes:e.notes||null,photo_url:e.photoUrl||null,logged_at:e.timestamp,purpose:e.purpose||null}).eq("id",e.id).select().single();if(t)throw t;return n},onSuccess:()=>{i.invalidateQueries({queryKey:["supplement_logs",r]})}}),d=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{error:n}=await o.from("supplement_logs").delete().eq("id",e);if(n)throw n},onSuccess:()=>{i.invalidateQueries({queryKey:["supplement_logs",r]})}});return{logs:u.data??[],isLoading:u.isLoading,createLog:c.mutateAsync,isCreating:c.isPending,updateLog:l.mutateAsync,isUpdating:l.isPending,deleteLog:d.mutateAsync,isDeleting:d.isPending}}function C(r){const{user:s}=_(),i=p(),u=y({queryKey:["poop_logs",r],queryFn:async()=>{if(!s||!r)return[];const{data:e,error:n}=await o.from("poop_logs").select("*").eq("pet_id",r).order("logged_at",{ascending:!1});if(n)throw n;return e.map(t=>({id:t.id,petId:t.pet_id,consistency:t.consistency,color:t.color,amount:t.amount,location:t.location||"",notes:t.notes||void 0,photoUrl:t.photo_url||void 0,thumbnailUrl:t.thumbnail_url||void 0,timestamp:t.logged_at,userRating:t.user_rating??void 0,aiStatus:t.ai_status,aiLabels:t.ai_labels,aiSummary:t.ai_summary||void 0,aiRiskLevel:t.ai_risk_level,bloodPresent:t.blood_present??void 0,moistureLevel:t.moisture_level,mucusPresent:t.mucus_present??void 0,smellLevel:t.smell_level?Number(t.smell_level):void 0,undesirableBehaviors:t.undesirable_behaviors??void 0,undesirableBehaviorNotes:t.undesirable_behavior_notes??void 0}))},enabled:!!s&&!!r}),c=a({mutationFn:async e=>{var m;if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("poop_logs").insert({pet_id:e.petId,user_id:s.id,consistency:e.consistency,color:e.color,amount:e.amount,location:e.location||null,notes:e.notes||null,photo_url:e.photoUrl||null,thumbnail_url:e.thumbnailUrl||null,user_rating:e.userRating||null,ai_status:e.aiStatus,logged_at:e.timestamp,blood_present:typeof e.bloodPresent=="boolean"?e.bloodPresent:null,moisture_level:e.moistureLevel||null,mucus_present:typeof e.mucusPresent=="boolean"?e.mucusPresent:null,smell_level:e.smellLevel||null,undesirable_behaviors:(m=e.undesirableBehaviors)!=null&&m.length?e.undesirableBehaviors:null,undesirable_behavior_notes:e.undesirableBehaviorNotes||null}).select().single();if(t)throw t;return n},onSuccess:e=>{i.invalidateQueries({queryKey:["poop_logs",r]}),h("poop_log",{log_id:e==null?void 0:e.id})}}),l=a({mutationFn:async e=>{var m;if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("poop_logs").update({consistency:e.consistency,color:e.color,amount:e.amount,location:e.location||null,notes:e.notes||null,photo_url:e.photoUrl||null,thumbnail_url:e.thumbnailUrl||null,user_rating:e.userRating||null,logged_at:e.timestamp,blood_present:typeof e.bloodPresent=="boolean"?e.bloodPresent:null,moisture_level:e.moistureLevel||null,mucus_present:typeof e.mucusPresent=="boolean"?e.mucusPresent:null,smell_level:e.smellLevel||null,undesirable_behaviors:(m=e.undesirableBehaviors)!=null&&m.length?e.undesirableBehaviors:null,undesirable_behavior_notes:e.undesirableBehaviorNotes||null}).eq("id",e.id).select().single();if(t)throw t;return n},onSuccess:()=>{i.invalidateQueries({queryKey:["poop_logs",r]})}}),d=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{error:n}=await o.from("poop_logs").delete().eq("id",e);if(n)throw n},onSuccess:()=>{i.invalidateQueries({queryKey:["poop_logs",r]})}});return{logs:u.data??[],isLoading:u.isLoading,createLog:c.mutateAsync,isCreating:c.isPending,updateLog:l.mutateAsync,isUpdating:l.isPending,deleteLog:d.mutateAsync,isDeleting:d.isPending}}function K(r){const{user:s}=_(),i=p(),u=y({queryKey:["measurement_logs",r],queryFn:async()=>{if(!s||!r)return[];const{data:e,error:n}=await o.from("measurement_logs").select("*").eq("pet_id",r).order("logged_at",{ascending:!1});if(n)throw n;return e.map(t=>({id:t.id,petId:t.pet_id,weightKg:t.weight_kg?Number(t.weight_kg):void 0,neckCm:t.neck_cm?Number(t.neck_cm):void 0,chestCm:t.chest_cm?Number(t.chest_cm):void 0,bodyLengthCm:t.body_length_cm?Number(t.body_length_cm):void 0,notes:t.notes||void 0,timestamp:t.logged_at}))},enabled:!!s&&!!r}),c=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("measurement_logs").insert({pet_id:e.petId,user_id:s.id,weight_kg:e.weightKg||null,neck_cm:e.neckCm||null,chest_cm:e.chestCm||null,body_length_cm:e.bodyLengthCm||null,notes:e.notes||null,logged_at:e.timestamp}).select().single();if(t)throw t;return n},onSuccess:e=>{i.invalidateQueries({queryKey:["measurement_logs",r]}),h("measurement_log",{log_id:e==null?void 0:e.id})}}),l=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{data:n,error:t}=await o.from("measurement_logs").update({weight_kg:e.weightKg||null,neck_cm:e.neckCm||null,chest_cm:e.chestCm||null,body_length_cm:e.bodyLengthCm||null,notes:e.notes||null,logged_at:e.timestamp}).eq("id",e.id).select().single();if(t)throw t;return n},onSuccess:()=>{i.invalidateQueries({queryKey:["measurement_logs",r]})}}),d=a({mutationFn:async e=>{if(!s)throw new Error("Not authenticated");const{error:n}=await o.from("measurement_logs").delete().eq("id",e);if(n)throw n},onSuccess:()=>{i.invalidateQueries({queryKey:["measurement_logs",r]})}});return{logs:u.data??[],isLoading:u.isLoading,createLog:c.mutateAsync,isCreating:c.isPending,updateLog:l.mutateAsync,isUpdating:l.isPending,deleteLog:d.mutateAsync,isDeleting:d.isPending}}export{C as a,P as b,K as c,L as d,N as u};
