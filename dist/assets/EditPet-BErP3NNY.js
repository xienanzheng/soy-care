import{u as T,o as U,b as E,r as m,j as e,d as n,t as d}from"./index-DykhQkCz.js";import{M as j,a as N,P as y,B as I}from"./MobileLayout-D0P8EqVx.js";import{I as i}from"./input-BtP13zn0.js";import{P as R}from"./PhotoUpload-DYIKrCeN.js";import{u as F}from"./usePhotoUpload-Bns2eVj-.js";import{a as L}from"./petAge-D-c7gpnm.js";import{A as M,a as G,b as z,c as _,d as $,e as q,f as V,g as Y,h as J}from"./alert-dialog-Dm62moyN.js";import{A as C}from"./arrow-left-CdLBjOwR.js";import{T as K}from"./trash-2-AfDv_LSy.js";import"./differenceInMonths-DSTze7pK.js";import"./differenceInCalendarDays-qwJqrl5B.js";import"./index-Dsh9-iej.js";const Q=["Dog","Cat","Rabbit","Hamster","Guinea Pig","Others"],h={Dog:["Golden Retriever","Beagle","Terrier","Corgi","Border Collie","Pomeranian","Spitz","Great Dane","Poodle","Maltese","Others"],Cat:["Persian","Siamese","Maine Coon","Ragdoll","British Shorthair","Others"],Rabbit:["Holland Lop","Mini Rex","Netherland Dwarf","Others"],Hamster:["Syrian","Dwarf","Roborovski","Others"],"Guinea Pig":["American","Peruvian","Abyssinian","Others"],Others:["Others"]},W=["Calm","Playful","Sensitive","High energy","Chill","Curious"];function ce(){var b;const o=T(),{petId:P}=U(),{pets:u,updatePet:A,deletePet:O,selectedPetId:B,setSelectedPetId:p,isUpdatingPet:x,isDeletingPet:g}=E(),{uploadPhoto:w,isUploading:c}=F(),[f,D]=m.useState(null),[t,l]=m.useState({name:"",species:"",breed:"",customBreed:"",photoUrl:"",handle:"",dateOfBirth:"",gender:"other",ownerName:"",medicalHistory:"",allergies:"",favoriteActivities:"",personality:""}),s=u.find(a=>a.id===P);if(m.useEffect(()=>{if(s){const a=s.species&&h[s.species]&&!h[s.species].includes(s.breed);l({name:s.name,species:s.species,breed:a?"Others":s.breed,customBreed:a?s.breed:"",photoUrl:s.photoUrl||"",handle:s.handle.replace("@",""),dateOfBirth:s.dateOfBirth||"",gender:s.gender,ownerName:s.ownerName||"",medicalHistory:s.medicalHistory||"",allergies:s.allergies||"",favoriteActivities:s.favoriteActivities||"",personality:s.personality||""})}},[s]),!s)return e.jsxs(j,{children:[e.jsx(N,{leftAction:e.jsx("button",{onClick:()=>o("/pets"),className:"p-2 -ml-2",children:e.jsx(C,{className:"w-5 h-5"})}),title:"Pet not found"}),e.jsx(y,{className:"flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"This pet doesn't exist."})})]});const k=async()=>{const a=t.breed==="Others"?t.customBreed:t.breed;try{let r=t.photoUrl;if(f){const v=await w(f,"pet-photos","pets");v&&(r=v)}await A({id:s.id,name:t.name,handle:t.handle||t.name.toLowerCase().replace(/\s+/g,""),species:t.species,breed:a,gender:t.gender,dateOfBirth:t.dateOfBirth||void 0,photoUrl:r||void 0,ownerName:t.ownerName||void 0,medicalHistory:t.medicalHistory||void 0,allergies:t.allergies||void 0,favoriteActivities:t.favoriteActivities||void 0,personality:t.personality||void 0}),d({title:"Pet updated!",description:`${t.name}'s profile has been saved.`}),o("/pets")}catch(r){d({title:"Failed to update pet",description:r.message,variant:"destructive"})}},S=async()=>{try{if(await O(s.id),B===s.id){const a=u.filter(r=>r.id!==s.id);a.length>0?p(a[0].id):p(null)}d({title:"Pet deleted",description:`${s.name} has been removed.`}),o("/pets")}catch(a){d({title:"Failed to delete pet",description:a.message,variant:"destructive"})}},H=t.name.trim().length>0&&t.species.length>0&&(t.breed!=="Others"?t.breed.length>0:t.customBreed.trim().length>0);return e.jsxs(j,{children:[e.jsx(N,{leftAction:e.jsx("button",{onClick:()=>o("/pets"),className:"p-2 -ml-2",children:e.jsx(C,{className:"w-5 h-5"})}),title:"Edit Pet",rightAction:e.jsxs(M,{children:[e.jsx(G,{asChild:!0,children:e.jsx("button",{className:"p-2 -mr-2 text-destructive",children:e.jsx(K,{className:"w-5 h-5"})})}),e.jsxs(z,{children:[e.jsxs(_,{children:[e.jsxs($,{children:["Delete ",s.name,"?"]}),e.jsxs(q,{children:["This action cannot be undone. All logs and measurements for ",s.name," will also be deleted."]})]}),e.jsxs(V,{children:[e.jsx(Y,{children:"Cancel"}),e.jsx(J,{onClick:S,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:g,children:g?"Deleting...":"Delete"})]})]})]})}),e.jsxs(y,{className:"flex flex-col pb-8",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx(R,{value:t.photoUrl,onChange:a=>l({...t,photoUrl:a||""}),onFileSelect:a=>D(a),isUploading:c,size:"lg",shape:"square"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Name"}),e.jsx(i,{placeholder:"e.g., Luna",value:t.name,onChange:a=>l({...t,name:a.target.value})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Handle"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",children:"@"}),e.jsx(i,{placeholder:t.name?t.name.toLowerCase().replace(/\s+/g,""):"soycraftpup",value:t.handle,onChange:a=>l({...t,handle:a.target.value}),className:"pl-8"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Owner name"}),e.jsx(i,{placeholder:"e.g., Taylor Chen",value:t.ownerName,onChange:a=>l({...t,ownerName:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Favourite activities"}),e.jsx(i,{placeholder:"e.g., trails, agility, naps",value:t.favoriteActivities,onChange:a=>l({...t,favoriteActivities:a.target.value})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Personality"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W.map(a=>e.jsx("button",{onClick:()=>l({...t,personality:a}),className:n("px-4 py-2 rounded-full text-sm font-medium transition-all",t.personality===a?"bg-primary text-primary-foreground":"bg-card-muted hover:bg-card-subtle"),children:a},a))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Medical history"}),e.jsx("textarea",{placeholder:"Chicken sensitivity; pancreatitis flare in 2023",value:t.medicalHistory,onChange:a=>l({...t,medicalHistory:a.target.value}),className:"w-full h-24 rounded-xl bg-card-subtle px-4 py-3 text-foreground placeholder:text-muted-foreground resize-none focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Allergies"}),e.jsx(i,{placeholder:"e.g., chicken protein, grass",value:t.allergies,onChange:a=>l({...t,allergies:a.target.value})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Species"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(a=>e.jsx("button",{onClick:()=>l({...t,species:a,breed:"",customBreed:""}),className:n("px-4 py-2 rounded-full text-sm font-medium transition-all",t.species===a?"bg-primary text-primary-foreground":"bg-card-muted hover:bg-card-subtle"),children:a},a))})]}),t.species&&e.jsxs("div",{className:"mb-6 animate-fade-in",children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Breed"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(b=h[t.species])==null?void 0:b.map(a=>e.jsx("button",{onClick:()=>l({...t,breed:a,customBreed:a==="Others"?t.customBreed:""}),className:n("px-4 py-2 rounded-full text-sm font-medium transition-all",t.breed===a?"bg-primary text-primary-foreground":"bg-card-muted hover:bg-card-subtle"),children:a},a))}),t.breed==="Others"&&e.jsx("div",{className:"mt-4 animate-fade-in",children:e.jsx(i,{placeholder:"Enter breed name",value:t.customBreed,onChange:a=>l({...t,customBreed:a.target.value})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Gender"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["male","female","other"].map(a=>e.jsx("button",{onClick:()=>l({...t,gender:a}),className:n("px-4 py-2 rounded-full text-sm font-medium transition-all capitalize",t.gender===a?"bg-primary text-primary-foreground":"bg-card-muted hover:bg-card-subtle"),children:a},a))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Date of Birth"}),e.jsx(i,{type:"date",placeholder:"2021-09-15",value:t.dateOfBirth,onChange:a=>l({...t,dateOfBirth:a.target.value}),max:new Date().toISOString().split("T")[0]}),t.dateOfBirth&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Age: ",L(t.dateOfBirth)]})]}),e.jsx(I,{onClick:k,disabled:!H||x||c,className:"w-full",children:x||c?"Saving...":"Save Changes"})]})]})}export{ce as default};
