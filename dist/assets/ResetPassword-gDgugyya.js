import{c as y,u as N,r as s,j as e,s as u,t as a}from"./index-DykhQkCz.js";import{M as P,a as S,P as C,B as m}from"./MobileLayout-D0P8EqVx.js";import{I as p}from"./input-BtP13zn0.js";import{E as k,a as E}from"./eye-BeH1UEcf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=y("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function M(){const i=N(),[r,f]=s.useState(""),[l,h]=s.useState(""),[o,x]=s.useState(!1),[d,c]=s.useState(!1),[w,g]=s.useState(!1),[j,v]=s.useState(!1);s.useEffect(()=>{(async()=>{const{data:{session:n}}=await u.auth.getSession();n?v(!0):(a({title:"Invalid or expired link",description:"Please request a new password reset link.",variant:"destructive"}),i("/forgot-password"))})()},[i]);const b=async t=>{if(t.preventDefault(),r!==l){a({title:"Passwords don't match",description:"Please make sure both passwords are the same.",variant:"destructive"});return}if(r.length<6){a({title:"Password too short",description:"Password must be at least 6 characters.",variant:"destructive"});return}c(!0);const{error:n}=await u.auth.updateUser({password:r});if(c(!1),n){a({title:"Error",description:n.message,variant:"destructive"});return}g(!0),a({title:"Password updated",description:"Your password has been successfully reset."})};return j?e.jsxs(P,{children:[e.jsx(S,{}),e.jsx(C,{className:"flex flex-col items-center justify-center",children:w?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mx-auto",children:e.jsx(I,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-semibold mb-2",children:"Password reset"}),e.jsx("p",{className:"text-muted-foreground",children:"Your password has been successfully reset."})]}),e.jsx(m,{onClick:()=>i("/dashboard"),className:"w-full",children:"Continue to Dashboard"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-display font-semibold mb-2",children:"Set new password"}),e.jsx("p",{className:"text-muted-foreground",children:"Your new password must be different from previous passwords."})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4 w-full",children:[e.jsxs("div",{className:"relative",children:[e.jsx(p,{type:o?"text":"password",placeholder:"New password",value:r,onChange:t=>f(t.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>x(!o),className:"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:o?e.jsx(k,{className:"w-5 h-5"}):e.jsx(E,{className:"w-5 h-5"})})]}),e.jsx(p,{type:o?"text":"password",placeholder:"Confirm new password",value:l,onChange:t=>h(t.target.value),required:!0}),e.jsx(m,{type:"submit",className:"w-full",disabled:d,children:d?"Updating...":"Reset password"})]})]})})]}):null}export{M as default};
