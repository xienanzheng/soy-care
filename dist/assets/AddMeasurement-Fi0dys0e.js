import{u as p,b as x,r as b,j as t,X as v,t as r}from"./index-DykhQkCz.js";import{M as C,a as f,P as j,B as y}from"./MobileLayout-D0P8EqVx.js";import{I as n}from"./input-BtP13zn0.js";import{P as k}from"./PetSelector-DeSwfx4H.js";import{c as w,d as N}from"./useLogs-xxhwBdP6.js";import{f as i}from"./format-DsNdWjgr.js";import"./PetAvatar-Bi96YrWD.js";import"./plus-CKAhW2G1.js";import"./differenceInCalendarDays-qwJqrl5B.js";import"./rewards-DUz26ILh.js";function T(){const o=p(),{pets:d,selectedPet:c,selectedPetId:l,setSelectedPetId:h}=x(),{createLog:g,isCreating:m}=w(l),[e,s]=b.useState({weightKg:"",neckCm:"",chestCm:"",bodyLengthCm:"",notes:"",date:i(new Date,"yyyy-MM-dd"),time:new Date().toTimeString().slice(0,5)}),u=async()=>{if(!c||!l){r({title:"No pet selected",variant:"destructive"});return}if(!e.weightKg&&!e.neckCm&&!e.chestCm&&!e.bodyLengthCm){r({title:"Please enter at least one measurement",variant:"destructive"});return}try{const a=new Date(`${e.date}T${e.time}`).toISOString();await g({petId:l,weightKg:e.weightKg?parseFloat(e.weightKg):void 0,neckCm:e.neckCm?parseFloat(e.neckCm):void 0,chestCm:e.chestCm?parseFloat(e.chestCm):void 0,bodyLengthCm:e.bodyLengthCm?parseFloat(e.bodyLengthCm):void 0,notes:e.notes||void 0,timestamp:a}),r({title:"Measurement added",description:e.weightKg?`Weight: ${e.weightKg}kg`:"Measurements saved"}),o("/dashboard")}catch(a){r({title:"Failed to add measurement",description:a.message,variant:"destructive"})}};return t.jsxs(C,{children:[t.jsx(f,{title:"Add Measurements",leftAction:t.jsx("button",{onClick:()=>o(-1),className:"p-2 -ml-2",children:t.jsx(v,{className:"w-5 h-5"})})}),t.jsxs(j,{className:"space-y-6",children:[t.jsx(k,{pets:d,selectedPetId:l,onSelectPet:h,showAddButton:!1}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Date"}),t.jsx(n,{type:"date",placeholder:"2024-05-01",value:e.date,onChange:a=>s({...e,date:a.target.value}),max:i(N(new Date,1),"yyyy-MM-dd")})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Time"}),t.jsx(n,{type:"time",placeholder:"08:30",value:e.time,onChange:a=>s({...e,time:a.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Weight (kg)"}),t.jsx(n,{type:"number",step:"0.1",placeholder:"6.5",value:e.weightKg,onChange:a=>s({...e,weightKg:a.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Neck Circumference (cm)"}),t.jsx(n,{type:"number",step:"0.1",placeholder:"28",value:e.neckCm,onChange:a=>s({...e,neckCm:a.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Chest/Girth (cm)"}),t.jsx(n,{type:"number",step:"0.1",placeholder:"45",value:e.chestCm,onChange:a=>s({...e,chestCm:a.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Body Length (cm)"}),t.jsx(n,{type:"number",step:"0.1",placeholder:"52",value:e.bodyLengthCm,onChange:a=>s({...e,bodyLengthCm:a.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Notes"}),t.jsx("textarea",{placeholder:"e.g., Weighed after morning walk",value:e.notes,onChange:a=>s({...e,notes:a.target.value}),className:"w-full h-24 rounded-xl bg-card-subtle px-4 py-3 text-foreground placeholder:text-muted-foreground resize-none focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),t.jsx(y,{onClick:u,className:"w-full mt-8",disabled:m,children:m?"Saving...":"Save Measurements"})]})]})}export{T as default};
